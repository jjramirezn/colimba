#include <stdio.h>
#include <time.h>

int binsearch_1(int x, int v[], int n);
int binsearch_2(int x, int v[], int n);

int data[1000] = {176,241,254,361,413,420,505,580,616,659,665,673,725,805,919,921,957,988,1154,1241,1295,1420,1442,1444,1497,1505,1538,1538,1538,1653,1668,1674,1837,1842,1950,1957,2116,2184,2261,2306,2318,2326,2458,2515,2567,2569,2597,2644,2650,2687,2693,2730,2845,2924,2956,2961,2962,3045,3047,3160,3161,3166,3184,3190,3209,3268,3358,3438,3458,3516,3519,3568,3673,3857,3859,4029,4035,4036,4070,4150,4323,4376,4385,4500,4600,4623,4638,4646,4668,4764,4838,5047,5098,5154,5158,5164,5210,5261,5265,5319,5468,5624,5741,5847,5964,6008,6028,6047,6086,6093,6147,6314,6360,6533,6654,6713,6740,6809,6848,6874,6896,6946,6949,6961,6994,7028,7065,7076,7157,7178,7197,7215,7238,7328,7475,7518,7592,7603,7733,7768,7846,7863,7881,8010,8035,8162,8273,8300,8338,8405,8537,8618,8663,8696,8725,8822,8854,8883,8901,8925,8929,8933,8950,9031,9048,9115,9141,9145,9205,9234,9236,9534,9544,9646,9674,9676,9723,9764,10028,10108,10157,10163,10245,10306,10346,10374,10453,10640,10720,10809,10840,10842,10864,10899,11000,11097,11098,11108,11115,11169,11246,11350,11393,11454,11560,11739,11761,11789,11932,11956,12206,12227,12275,12310,12331,12452,12495,12549,12661,12750,12797,12872,12873,12916,12952,12990,13022,13047,13081,13089,13236,13250,13470,13505,13543,13890,14013,14198,14272,14315,14347,14387,14453,14481,14489,14621,14673,14766,14767,14905,15138,15157,15211,15230,15234,15273,15346,15364,15533,15557,15691,15760,15835,15859,15915,16038,16091,16113,16209,16287,16366,16549,16577,16604,16760,16863,16874,17023,17118,17118,17249,17284,17324,17419,17531,17688,17793,17798,17821,17982,17991,17993,18204,18280,18298,18354,18395,18418,18420,18486,18498,18567,18576,18753,18777,18813,18816,18870,18892,18975,19056,19080,19117,19124,19165,19280,19294,19344,19347,19420,19469,19504,19575,19602,19628,19759,20072,20125,20129,20155,20260,20261,20282,20302,20391,20439,20440,20562,20641,20686,20698,20713,20747,20785,20822,21210,21289,21316,21377,21399,21428,21437,21444,21454,21498,21577,21851,21859,21937,22097,22119,22138,22228,22312,22413,22428,22508,22567,22824,22886,22901,23042,23063,23208,23409,23428,23442,23459,23550,23575,23635,23639,23661,23708,23722,23863,23874,23954,24340,24351,24453,24514,24687,24765,24831,24873,24936,25028,25043,25166,25177,25214,25264,25282,25448,25479,25540,25742,25816,25841,25876,25891,25914,26105,26375,26389,26449,26654,26744,26783,26954,27041,27081,27188,27257,27356,27378,27477,27554,27582,27625,27717,27736,27830,27902,27918,27956,28045,28098,28145,28227,28273,28471,28521,28566,28646,28685,28746,28772,28778,28914,29025,29050,29091,29096,29100,29167,29237,29267,29321,29358,29394,29495,29505,29520,29540,29547,29634,29669,29680,29803,29840,29914,29928,29976,29981,30006,30130,30179,30270,30320,30364,30405,30432,30433,30532,30656,30809,30837,30963,31074,31174,31269,31359,31527,31557,31753,31804,31807,31826,31875,31921,32089,32187,32198,32211,32251,32363,32430,32623,32644,32734,32749,32752,32818,32856,32929,33059,33098,33112,33198,33201,33499,33503,33539,33550,33588,33613,33650,33679,33929,34137,34194,34364,34453,34594,34595,34708,34979,35150,35162,35213,35307,35399,35455,35459,35467,35508,35552,35666,35747,35800,35825,35828,35851,35897,36015,36074,36083,36091,36100,36141,36141,36183,36221,36259,36297,36394,36411,36505,36512,36626,36655,36784,37235,37277,37295,37334,37367,37531,37970,38078,38216,38231,38352,38434,38540,38551,38553,38562,39001,39198,39278,39300,39300,39316,39363,39387,39388,39428,39476,39530,39592,39597,39643,39837,39875,39887,40038,40167,40174,40184,40199,40216,40231,40270,40335,40435,40465,40548,40661,40698,40786,40786,40805,40822,40884,40900,40941,40959,40961,40995,41081,41178,41191,41401,41414,41571,41576,41579,41610,41626,41647,41684,41931,41932,41959,41993,42041,42088,42124,42247,42328,42434,42449,42484,42489,42717,42757,42767,42873,42896,42902,42908,42994,43104,43111,43145,43156,43159,43272,43273,43280,43285,43441,43479,43527,43644,43652,43725,43801,43859,43859,43872,43879,44009,44061,44083,44213,44365,44500,44786,44798,44864,44947,44981,45065,45106,45148,45209,45214,45245,45281,45318,45463,45474,45508,45535,45657,45686,45804,45834,45866,45920,45985,45988,46107,46124,46256,46345,46425,46475,46675,46688,46816,46869,46887,46958,47073,47105,47219,47290,47291,47547,47649,47680,47701,47712,47723,47776,47913,48088,48100,48204,48276,48415,48522,48585,48650,48714,48749,48786,48857,48873,48912,48950,49021,49060,49164,49218,49224,49470,49494,49594,49624,49642,49709,49719,49802,49909,50117,50153,50208,50211,50282,50354,50389,50438,50451,50562,50645,50720,50777,50805,50913,50919,50971,50972,51009,51028,51150,51263,51468,51487,51683,51718,51859,51950,52264,52317,52464,52513,52518,52623,52656,52663,52669,52683,52800,52804,52859,52962,53000,53295,53514,53537,53584,53604,53640,53680,53809,53870,53897,53931,53957,53985,54171,54191,54228,54433,54489,54532,54545,54656,54788,54810,54841,55003,55161,55201,55213,55299,55333,55334,55524,55623,55646,55648,55743,55847,55871,56091,56279,56318,56348,56422,56529,56555,56558,56558,56580,56625,56643,56693,56717,56730,56792,56840,57010,57162,57173,57351,57407,57551,57581,57598,57651,57793,57887,57938,57976,58073,58177,58437,58475,58644,58675,58750,58774,58843,58870,58904,58929,59032,59134,59238,59301,59331,59407,59427,59464,59480,59509,59618,59689,59805,59852,59885,59911,59931,60032,60104,60171,60176,60378,60433,60439,60461,60513,60521,60540,60555,60591,60606,60621,60708,60832,60939,60982,61049,61071,61076,61112,61231,61242,61310,61322,61337,61363,61518,61528,61538,61565,61627,61743,61781,61804,61809,61811,61813,61951,61983,62072,62217,62360,62377,62405,62455,62461,62504,62597,62703,62857,62973,63086,63105,63107,63148,63207,63222,63296,63363,63665,63680,63752,63886,63888,63918,63926,64113,64132,64287,64297,64338,64509,64518,64538,64563,64632,64832,64851,64856,64943,65035,65225,65342,65369,65387,65507,65511};
int search[1000] = {57,75,106,321,373,401,447,483,552,598,666,671,718,784,790,843,868,893,911,914,1052,1055,1116,1140,1145,1332,1365,1386,1427,1450,1515,1578,1581,1599,1628,1660,1725,1737,1912,1915,2030,2055,2081,2119,2175,2302,2684,2749,2760,3002,3081,3407,3479,3517,3632,3695,3737,3818,3843,3932,3962,4092,4095,4150,4223,4387,4423,4522,4562,4588,4612,4646,4711,4723,4729,4731,4746,4751,4834,4839,4866,4947,4991,5067,5160,5182,5213,5223,5261,5273,5321,5392,5392,5496,5550,5618,5628,5850,5884,5940,5951,6043,6084,6106,6206,6268,6296,6306,6440,6489,6493,6535,6566,6590,6634,6685,6719,6805,6883,6890,7041,7062,7079,7278,7290,7406,7424,7463,7530,7581,7594,7700,7830,7954,7958,8120,8152,8158,8233,8266,8332,8368,8369,8371,8398,8402,8467,8671,8689,8723,8772,8844,8991,9141,9261,9270,9361,9550,9586,9665,9972,9992,10007,10077,10126,10256,10283,10365,10462,10484,10728,10769,10857,10874,10904,11106,11237,11328,11329,11400,11418,11450,11463,11559,11598,11617,11622,11685,11689,11693,11725,11866,12001,12004,12011,12198,12289,12585,12625,12631,12747,12756,12762,12820,12861,12869,12872,13150,13180,13231,13237,13290,13353,13424,13429,13449,13478,13505,13518,13520,13531,13646,13677,13687,13722,13850,14043,14070,14088,14137,14421,14452,14492,14665,14710,14740,14778,14859,14868,14901,14927,15026,15072,15142,15198,15263,15508,15541,15547,15778,15804,15870,15878,15902,16168,16216,16242,16250,16270,16274,16283,16305,16458,16534,16542,16590,16626,16675,16732,16916,16926,16945,17070,17167,17180,17215,17232,17311,17350,17620,17733,17949,17966,17974,17987,18026,18051,18073,18076,18087,18092,18208,18347,18385,18417,18428,18439,18454,18488,18510,18555,18567,18584,18606,18611,18614,18638,18814,18883,18921,18927,18994,19034,19089,19115,19203,19234,19319,19366,19642,19657,19743,19789,19876,19939,20140,20143,20173,20200,20234,20285,20413,20423,20440,20508,20590,20619,20653,20656,20749,20784,20878,20896,21046,21154,21170,21238,21288,21289,21315,21317,21450,21485,21515,21585,21682,21876,21917,21974,22172,22245,22258,22267,22273,22473,22498,22617,22732,22846,22866,22935,22988,23028,23294,23343,23354,23457,23499,23528,23705,23722,23840,23893,24007,24027,24122,24138,24189,24230,24300,24315,24362,24398,24462,24471,24513,24631,24680,24823,24918,24958,25009,25169,25272,25545,25553,25641,25703,25752,25761,25807,25833,25890,26059,26068,26226,26276,26277,26378,26382,26436,26437,26502,26685,26691,26754,27013,27029,27103,27121,27252,27336,27434,27464,27518,27869,27951,28059,28153,28153,28190,28366,28397,28437,28566,28571,28639,28673,28882,28945,28970,29001,29057,29315,29346,29389,29558,29571,29735,29835,29847,29874,29915,30021,30033,30073,30079,30273,30302,30320,30370,30417,30447,30456,30475,30496,30535,30541,30624,30655,30680,30816,30816,30888,30966,31045,31126,31169,31191,31302,31313,31406,31500,31514,31574,31585,31624,31872,31886,31979,32218,32228,32234,32274,32281,32290,32329,32510,32513,32605,32611,32654,32685,32696,32723,32763,32811,32827,32839,32859,33012,33126,33191,33281,33288,33415,33600,33602,33634,33660,33798,33840,33884,34021,34067,34148,34157,34244,34340,34361,34585,34669,34715,34754,34806,34885,34910,35347,35367,35395,35758,35787,35820,36040,36183,36189,36205,36243,36338,36432,36513,36534,36673,36722,36904,36959,37126,37151,37238,37482,37596,37617,37835,37901,37942,38002,38040,38198,38301,38358,38409,38495,38606,38791,38791,38797,38832,38852,38884,39174,39177,39219,39296,39491,39543,39638,39645,39666,39672,39683,39747,39749,39815,40045,40083,40084,40185,40215,40239,40297,40466,40517,40602,40605,40677,40770,40833,40834,40857,40922,41111,41201,41225,41377,41517,41560,41573,41651,41656,41693,41808,41860,41949,41972,42030,42031,42046,42052,42075,42081,42144,42195,42264,42305,42318,42418,42432,42439,42579,42645,42657,42662,42724,42736,42754,42762,42814,42861,42886,42930,43009,43043,43119,43174,43326,43367,43460,43490,43597,43624,43634,43766,43842,43957,43990,43998,44217,44289,44389,44509,44608,44653,44698,44739,44836,44962,45001,45019,45026,45071,45111,45115,45215,45276,45451,45453,45480,45482,45538,45569,45804,45808,45895,45988,45999,46012,46040,46040,46068,46169,46251,46291,46307,46316,46402,46433,46503,46507,46516,46582,46611,46705,46717,46789,46864,46892,46904,46921,46967,47198,47311,47407,47410,47543,47554,47760,47834,47863,47947,47991,48068,48073,48121,48175,48259,48372,48458,48522,48540,48601,48681,48822,48836,48906,48969,49042,49101,49132,49196,49255,49277,49313,49315,49339,49352,49386,49499,49511,49546,49564,49621,49747,49805,49809,49902,49902,49976,50117,50208,50225,50255,50286,50309,50390,50391,50411,50438,50491,50557,50665,50802,50828,51012,51059,51162,51204,51568,51761,51968,51987,52026,52146,52208,52296,52316,52539,52549,52779,52808,52904,52923,52944,52982,53001,53022,53118,53254,53283,53322,53433,53439,53609,53715,53738,53835,53882,53901,53956,53975,54013,54076,54088,54128,54156,54218,54305,54403,54410,54441,54463,54516,54545,54566,54583,54608,54777,54787,54832,54864,54970,55093,55107,55111,55272,55331,55456,55474,55495,55555,55620,55632,55658,55672,55704,55713,55715,55722,55779,55851,55888,55968,55983,55989,56033,56290,56349,56485,57044,57074,57090,57224,57256,57615,57620,57683,57856,57903,57951,57974,57997,58012,58061,58280,58293,58367,58381,58544,58623,58900,58915,58919,58946,58955,59078,59169,59259,59315,59349,59433,59569,59731,59736,59750,59858,59930,59986,60064,60069,60120,60134,60137,60186,60357,60501,60526,60637,60637,60639,60706,60747,60764,60950,61089,61153,61214,61275,61306,61329,61363,61469,61506,61529,61634,61702,61763,61788,61888,61921,61967,62002,62069,62071,62093,62158,62176,62234,62342,62468,62491,62549,62711,62750,62894,63021,63103,63115,63123,63149,63185,63226,63405,63456,63534,63598,63675,63709,63817,64021,64080,64100,64103,64299,64383,64446,64484,64671,64680,64687,64692,64720,64768,64863,64892,65035,65040,65146,65151,65332,65378,65472};

/* Exercise 3-1. Our binary search makes two tests inside the loop, when one
 * would suffice (at the price of more tests outside). Write a version with
 * only one test inside the loop and measure the difference in run-time.
 */
int main(void)
{
        clock_t start, end, sum1, sum2;
        unsigned int i, x, n;

        n = 1000;
        sum1 = sum2 = 0;

        for (i = 0; i < n; ++i) {
                x = search[i];
                start = clock();
                binsearch_1(x, data, n);
                end = clock();
                sum1 += end - start;
        }
        for (i = 0; i < n; ++i) {
                x = search[i];
                start = clock();
                binsearch_2(x, data, n);
                end = clock();
                sum2 += end - start;
        }
        printf("binsearch_1 used %.3f ticks or %.3e seconds in average\n", (double) sum1 / n, (double) sum1 / n / CLOCKS_PER_SEC);
        printf("binsearch_2 used %.3f ticks or %.3e seconds in average\n", (double) sum2 / n, (double) sum2 / n / CLOCKS_PER_SEC);
        return 0;
}


/* binsearch_1: find x in v[0] <= v[1] <= ... <= v[n-1]; direclty from book*/
int binsearch_1(int x, int v[], int n)
{
        int low, high, mid;

        low = 0;
        high = n - 1;
        while (low <= high) {
                mid = (low+high) / 2;
                if (x < v[mid]) {
                        high = mid - 1;
                } else if (x > v[mid]) {
                        low = mid + 1;
                } else {                        /* found match */
                        return mid;
                }
        }
        return -1;                              /* no match */
}

/* binsearch_2: find x in v[0] <= v[1] <= ... <= v[n-1]; performs less checks
 * inside while
 */
int binsearch_2(int x, int v[], int n)
{
        int low, high, mid;

        low = 0;
        high = n - 1;
        mid = -1;
        while (mid != x && low <= high) {
                mid = (low+high) / 2;
                if (x < v[mid]) {
                        high = mid - 1;
                } else {
                        low = mid + 1;
                }
        }
        return mid;                              /* no match */
}
